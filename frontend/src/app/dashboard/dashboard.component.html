<mat-toolbar color="primary">Dashboard</mat-toolbar>

<!-- eroare globală -->
<mat-card *ngIf="error" class="mt-3" appearance="outlined" color="warn">
  <div class="alert alert-danger">{{ error }}</div>
</mat-card>

<!-- CARDURI INFO -->
<div class="cards grid gap-3 md:grid-cols-3 mt-3">
  <mat-card appearance="outlined">
    <div class="label text-sm text-muted">Studenți</div>
    <div class="value text-3xl font-semibold">{{ counts?.students ?? '—' }}</div>
  </mat-card>

  <mat-card appearance="outlined">
    <div class="label text-sm text-muted">Profesori</div>
    <div class="value text-3xl font-semibold">{{ counts?.professors ?? '—' }}</div>
  </mat-card>

  <mat-card appearance="outlined">
    <div class="label text-sm text-muted">Cursuri</div>
    <div class="value text-3xl font-semibold">{{ counts?.courses ?? '—' }}</div>
  </mat-card>
</div>

<!-- TOP STUDENȚI -->
<mat-card class="mt-4" appearance="outlined">
  <div class="panel-header flex items-center justify-between mb-2">
    <h3 class="m-0">Top studenți după medie</h3>

    <div class="flex items-center gap-3">
      <mat-form-field appearance="outline" style="width: 120px;">
        <mat-label>Top</mat-label>
        <input matInput type="number" min="1" [(ngModel)]="topSize" />
      </mat-form-field>

      <button mat-raised-button color="primary" (click)="loadAll()">
        <mat-icon>refresh</mat-icon>
        Reîncarcă
      </button>
    </div>
  </div>

  <table class="tbl w-100">
    <thead>
      <tr>
        <th>#</th>
        <th>Student</th>
        <th>Medie</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let s of topStudents; index as i">
        <td>{{ i + 1 }}</td>
        <td>{{ s.studentName }}</td>
        <td>{{ s.average | number:'1.2-2' }}</td>
      </tr>
      <tr *ngIf="!topStudents?.length">
        <td colspan="3" class="empty">Nu există date.</td>
      </tr>
    </tbody>
  </table>
</mat-card>

<!-- CURSURI POPULARE -->
<mat-card class="mt-4" appearance="outlined">
  <div class="panel-header flex items-center justify-between mb-2">
    <h3 class="m-0">Cursuri populare</h3>

    <div class="flex items-center gap-3">
      <mat-form-field appearance="outline" style="width: 120px;">
        <mat-label>Top</mat-label>
        <input matInput type="number" min="1" [(ngModel)]="popularSize" />
      </mat-form-field>

      <button mat-raised-button color="primary" (click)="loadAll()">
        <mat-icon>refresh</mat-icon>
        Reîncarcă
      </button>
    </div>
  </div>

  <table class="tbl w-100">
    <thead>
      <tr>
        <th>#</th>
        <th>Curs</th>
        <th>Note</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let c of popularCourses; index as i">
        <td>{{ i + 1 }}</td>
        <td>{{ c.courseName }}</td>
        <td>{{ c.gradesCount }}</td>
      </tr>
      <tr *ngIf="!popularCourses?.length">
        <td colspan="3" class="empty">Nu există date.</td>
      </tr>
    </tbody>
  </table>
</mat-card>
